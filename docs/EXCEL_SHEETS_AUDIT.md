# Аудит вкладок final_filled 30.01.xlsx

Сравнение: что есть в файле vs что читает импорт (import-final-filled.ts).

---

## 1. Список листов

| № | Лист | Строк (приблиз.) | Столбцов в файле | Используется импортом |
|---|------|------------------|-------------------|------------------------|
| 1 | Цены базовые | 504 | 12 | да |
| 2 | Цвет | 865 | 6 | да |
| 3 | Опции | 148 | 13 | да |
| 4 | Стекло_доступность | 86 | 4 | да |
| 5 | Наценка за кромку | 72 | 11 | да |
| 6 | Наличники | 17 | 4 | да |
| 7 | Фурнитура | 3 | 3 | да |
| 8 | 04 Ручки Завертки | 156 | 12 | да |
| 9 | 05 Ограничители | 25 | 7 | да |

---

## 2. По листам: столбцы в файле vs используемые импортом

### Цены базовые

**В файле (заголовки):**
- 1. `Код модели Domeo (Web)`
- 2. `Название модели`
- 3. `Стиль Domeo (Web)`
- 4. `Поставщик`
- 5. `Высота, мм`
- 6. `Ширины, мм`
- 7. `Толщина, мм`
- 8. `Тип покрытия`
- 9. `Стекло`
- 10. `Кромка в базе`
- 11. `Цена опт`
- 12. `Цена РРЦ`

**Импорт использует:**
- `Код модели Domeo (Web)`
- `Название модели`
- `Стиль Domeo (Web)`
- `Поставщик`
- `Высота, мм`
- `Ширины, мм`
- `Толщина, мм`
- `Тип покрытия`
- `Стекло`
- `Кромка в базе`
- `Цена опт`
- `Цена РРЦ`

---

### Цвет

**В файле (заголовки):**
- 1. `Название модели`
- 2. `Поставщик`
- 3. `Тип покрытия`
- 4. `Цвет/отделка`
- 5. `Ссылка на обложку`
- 6. `Ссылки на галерею (через ;)`

**Импорт использует:**
- `Название модели`
- `Поставщик`
- `Тип покрытия`
- `Цвет/отделка`
- `Ссылка на обложку`
- `Ссылки на галерею (через ;)`

---

### Опции

**В файле (заголовки):**
- 1. `Название модели`
- 2. `Поставщик`
- 3. `Название наполнения`
- 4. `Звукоизоляция (дБ)`
- 5. `Надбавка 2301-2500мм (%) к высоте 2000`
- 6. `Надбавка 2501-3000мм (%) к высоте 2000`
- 7. `Реверс доступен (Да/Нет)`
- 8. `Надбавка за реверс (руб)`
- 9. `Порог доступен (Да/Нет)`
- 10. `Цена порога (руб)`
- 11. `Зеркало доступно (Да/Нет)`
- 12. `Зеркало: Одна сторона (руб)`
- 13. `Зеркало: Две стороны (руб)`

**Импорт использует:**
- `Название модели`
- `Поставщик`
- `Название наполнения`
- `Звукоизоляция (дБ)`
- `Надбавка 2301-2500мм (%) к высоте 2000`
- `Надбавка 2501-3000мм (%) к высоте 2000`
- `Реверс доступен (Да/Нет)`
- `Надбавка за реверс (руб)`
- `Порог доступен (Да/Нет)`
- `Цена порога (руб)`
- `Зеркало доступно (Да/Нет)`
- `Зеркало: Одна сторона (руб)`
- `Зеркало: Две стороны (руб)`

---

### Стекло_доступность

**В файле (заголовки):**
- 1. `Код модели Domeo (Web)`
- 2. `Поставщик`
- 3. `Название модели`
- 4. `Доступные цвета стекол для модели`

**Импорт использует:**
- `Код модели Domeo (Web)`
- `Поставщик`
- `Название модели`
- `Доступные цвета стекол для модели`

---

### Наценка за кромку

**В файле (заголовки):**
- 1. `Название модели`
- 2. `Кромка включена в базовую цену (Да/Нет)`
- 3. `Базовая кромка (самая дешевая), Цвет`
- 4. `Опции кромки доступны (Да/Нет)`
- 5. `Наценка за кромку как за опцию`
- 6. `Цвет 2`
- 7. `Наценка за Цвет 2`
- 8. `Цвет 3`
- 9. `Наценка за Цвет 3`
- 10. `Цвет 4`
- 11. `Наценка за Цвет 4`

**Импорт использует:**
- `Название модели`
- `Кромка включена в базовую цену (Да/Нет)`
- `Базовая кромка (самая дешевая), Цвет`
- `Опции кромки доступны (Да/Нет)`
- `Наценка за кромку как за опцию`
- `Цвет 2`
- `Наценка за Цвет 2`
- `Цвет 3`
- `Наценка за Цвет 3`
- `Цвет 4`
- `Наценка за Цвет 4`

---

### Наличники

**В файле (заголовки):**
- 1. `Поставщик`
- 2. `Наличник: Название`
- 3. `Наличник: Описание`
- 4. `Наличник: Фото (ссылка)`

**Импорт использует:**
- `Поставщик`
- `Наличник: Название`
- `Наличник: Описание`
- `Наличник: Фото (ссылка)`

---

### Фурнитура

**В файле (заголовки):**
- 1. `Комплект фурнитуры: Название`
- 2. `Описание`
- 3. `Цена`

**Импорт использует:**
- `Комплект фурнитуры: Название`
- `Описание`
- `Цена`

---

### 04 Ручки Завертки

**В файле (заголовки):**
- 1. `Тип (Ручка/Завертка)`
- 2. `Название (Domeo_наименование для Web)`
- 3. `Описание`
- 4. `Группа`
- 5. `Цена продажи (руб)`
- 6. `Цена закупки (руб)`
- 7. `Цена РРЦ (руб)`
- 8. `Фото (ссылка)`
- 9. `Порядок сортировки`
- 10. `Активна (Да/Нет)`
- 11. `Завертка, цена РРЦ`
- 12. `Фото завертки (ссылка)`

**Импорт использует:**
- `Тип (Ручка/Завертка)`
- `Название (Domeo_наименование для Web)`
- `Описание`
- `Группа`
- `Цена продажи (руб)`
- `Цена закупки (руб)`
- `Цена РРЦ (руб)`
- `Фото (ссылка)`
- `Порядок сортировки`
- `Активна (Да/Нет)`
- `Завертка, цена РРЦ`
- `Фото завертки (ссылка)`

---

### 05 Ограничители

**В файле (заголовки):**
- 1. `ID товара`
- 2. `Название`
- 3. `Тип (магнитный врезной / напольный / настенный)`
- 4. `Описание`
- 5. `Цена опт (руб)`
- 6. `Цена РРЦ (руб)`
- 7. `Фото (путь)`

**Импорт использует:**
- `ID товара`
- `Название`
- `Тип (магнитный врезной / напольный / настенный)`
- `Описание`
- `Цена опт (руб)`
- `Цена РРЦ (руб)`
- `Фото (путь)`

---

## 3. Атрибуты дверей в properties_data

Импорт записывает в товар двери (Product.properties_data) поля из нескольких листов. Источники:

| Ключ в properties_data | Источник (лист → столбец) | Примечание |
|------------------------|----------------------------|------------|
| Код модели Domeo (Web) | Цены базовые | |
| Название модели, Domeo_Название модели для Web | Цены базовые → Название модели | |
| Артикул поставщика | Цены базовые → Код модели Domeo (Web) | |
| Стиль Domeo (Web), Domeo_Стиль Web | Цены базовые | |
| Ширина/мм, Высота/мм | Цены базовые (разворот по Ширины, мм × Высота, мм) | |
| Тип покрытия | Цены базовые | |
| Поставщик, Толщина мм, Стекло, Кромка в базе, Цена опт, Цена РРЦ | Цены базовые | |
| Domeo_Опции_* (реверс, порог, зеркало, наполнение и т.д.) | Опции (по Название модели) | Если модели нет в Опции — опций нет |
| Domeo_Опции_Поставщик | Опции → Поставщик | |
| Domeo_Стекло_доступность | Стекло_доступность (по Название модели) | |
| Domeo_Стекло_Поставщики | Стекло_доступность → Поставщик | массив уникальных поставщиков |
| Domeo_Цвет_Поставщики | Цвет → Поставщик | массив уникальных поставщиков по модели |
| Domeo_Кромка_* | Наценка за кромку (по Название модели) | Если модели нет — edge_in_base = Нет |

**Атрибуты, которых нет в Excel (и не заполняются импортом):**
- `Domeo_Цвет` — цвет выбирается в конфигураторе из списка (лист «Цвет» → PropertyPhoto); для товара двери одно значение на вариант не хранится, фильтр цены допускает null.
- `Тип конструкции` — в листе «Цены базовые» отдельного столбца нет; при необходимости добавить в Excel и в импорт.
